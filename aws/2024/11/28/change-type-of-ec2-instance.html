<!DOCTYPE html>
<html>
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EC2 인스턴스 유형 변경하기</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200..900&display=swap">
    <link rel="stylesheet" href="https://spsarolkar.github.io/rouge-theme-preview/css/syntax-gruvbox.dark.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nanum+Gothic+Coding:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700;800&display=swap">

    <link rel="stylesheet" href="https://recoma96.github.io/assets/css/main.css">
    <link rel="stylesheet" href="https://recoma96.github.io/assets/css/mathjax.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
    <body>
        <nav class="
        fixed layout-navbar
        w-full h-16 z-navbar
        text-light-primary-600 dark:text-dark-primary-default
        bg-light-primary-400 dark:bg-zinc-800 bg-opacity-80 backdrop-blur-[2px]
        dark:border-b dark:border-yellow-100
        shadow-navbar-light dark:shadow-navbar-darkq
">
    <div class="
        w-full
        flex justify-between items-center
    ">
        <i id="navbar-menu-button" class="nav-icon bi bi-list text-4xl xl:invisible"></i>

        <a id="navbar-title" href="/posts" class="
            text-lg hidden xl:block cursor-pointer no-underline font-bold text-white dark:text-dark-primary-200
        ">
            Recoma In DEV
        </a>

        <i id="navbar-mode-selector" class="nav-icon bi text-2xl"></i>
    </div>
</nav>

<ul id="navbar-menu" class="
    hidden fixed
    z-30 w-full mt-16 py-6
    bg-white dark:bg-zinc-950
    list-none
    flex flex-col gap-6 text-center
    shadow-navbar-menu
">
    <li class="border-buttom text-[1.2em]"><a class="no-underline text-current" href="/posts">Posts</a></li>
    <li class="border-buttom text-[1.2em]"><a class="no-underline text-current" href="/categories">Categories</a></li>
    <li class="border-buttom text-[1.2em]"><a class="no-underline text-current" href="/about"">About</a></li>
</ul>

        <div class="web-main-container">
            <div id="left-side-bar" class="
    hidden xl:block
    w-[300px] py-[100px] px-6
    bg-white dark:bg-zinc-900
    shadow-layout
">
    <div class="w-full text-center">
        <img src="/assets/img/profile.jpg" width="140px" height="140px"
            class="mx-auto rounded-full" alt="profile"
        />
        <h2 class="font-bold text-rose-400 dark:text-yellow-200">recoma</h2>
        <p>인생 재밌게 사는 방법 탐구중</p>
    </div>

    <div class="w-full mt-10 flex flex-wrap justify-center gap-8">
        
<a href="https://github.com/recoma96" class="social-icon text-inherit"><i class="bi bi-github social-icon-color" alt="github"></i></a>



<a href="mailto:seokbong60@gmail.com" class="social-icon text-inherit"><i class="bi bi-envelope-fill social-icon-color" alt="email"></i></a>










    </div>

    <div class="w-full h-[0px] border-b border-zinc-400 mt-8"></div>

    <div class="mt-8 w-full text-center flex flex-col gap-6">
        <a class="text-pink-600 dark:text-dark-text-default font-bold cursor-pointer no-underline" href="/posts">Posts</a>
        <a class="text-lime-600 dark:text-dark-text-default font-bold cursor-pointer no-underline" href="/categories">Categories</a>
        <a class="text-violet-600 dark:text-dark-text-default font-bold cursor-pointer no-underline" href="/about">About</a>
    </div>
</div>
<div class="w-[1px] bg-gray"></div>
            <div class="web-main-item">
                <div class="mb-20">
    <div class="text-center">
        <h2 class="
            px-10 py-4 inline-block
            bg-orange-100 text-orange-600 dark:text-yellow-200
            dark:bg-transparent dark:border-double dark:border dark:border-yellow-200 rounded-md
            shadow-paper-styled
        ">
            EC2 인스턴스 유형 변경하기
        </h2>
        <p class="font-semibold"><a href="/categories/#AWS" class="no-underline text-orange-700 dark:text-blue-200">AWS</a></p>
    </div>
    
    <div class="mt-10">
        <p class="text-[0.8em]">Posted <strong class="no-underline">2024.11.28 23:00</strong></p>
        <p class="text-[0.8em] -mt-2">By <strong class="no-underline">recoma</strong></p>
    </div>

    <div class="
        mt-6 h-[2px] bg-gradient-to-r
        from-white via-lime-400 to-white
        dark:from-zinc-900 dark:via-yellow-200 dark:to-zinc-900
    "></div>

    
</div>
                <h1 id="개요">개요</h1>

<p>사이드 프로젝트나 실무에서 대부분 서버를 돌릴 때 AWS EC2 인스턴스를 사용한다. 그런데, 사용하다 보면 인스턴스의 스펙을 올리거나 내려야 할 상황이 생긴다. 예를 들어 운영하고 있는 서버에 사용자가 증가하면서 트래픽이 많아지게 되고, 트래픽이 많아지게 되면서 CPU, RAM 사용량이 기하급수적으로 증가하게 된다면, 인스턴스 스펙을 올리는 <strong>스케일 업(Scale Up)</strong>을 고려해야 한다. (로드밸런싱을 적극 사용하고 있다면 서버 대수를 늘리는 <strong>스케일 (Scale Out)</strong>을 할 수도 있겠지만. 이번 포스트에서는 이게 주제가 아니므로 패스…). 혹은 사용 대비 비용이 너무 많이 들어가 돈낭비가 지속된다면 반대로 서버 스펙을 줄일 필요가 있다.</p>

<p><br /></p>

<p>순수 자체 구축된 컴퓨터를 사용하고 있다면, CPU또는 RAM을 직접 갈아끼워야 하는 수고가 만만치 않은 데다, 마더보드하고 호환되지 않을 경우 전체를 다 들어내야 하는 등, 많은 인력이 소모될 것이다. 하지만 AWS, Azure 같은 클라우드 서비스를 사용하고 있다면, 마우스 몇번 깔딱으로 스펙을 바꿀 수가 있다. 이번 포스트에서는 EC2의 유형을 변경하는 방법에 대해 설명한다.</p>

<h1 id="ec2-유형-변경하기">EC2 유형 변경하기</h1>

<h2 id="변경-전-점검사항">변경 전 점검사항</h2>

<p>EC2 유형을 변경한다는 것은 마치 본체를 갈아 끼운다는 것과 같다. 그렇기 때문에 유형을 변경하기에 앞서 몇가지 점검해야 할 사항이 있다.</p>

<h3 id="public-ip-변동-여부">Public IP 변동 여부</h3>

<p>EC2를 사용해 봤다면 당연히 알고있겠지만, 유형을 변경하기에 앞서 서버를 내리게 된다. 그리고 다시 올리게 되면 Public IP가 변경된다. Elastic IP를 사용하고 있다면 문제가 없겠지만, 그렇지 않다면 <strong>IP가 바뀜으로서, 영향이 가는 AWS 서비스가 있는지 검토해야 한다.</strong> 대표적으로 여러 인스턴스들을 연동해서 트래픽 분산을 해주는 ALB(어플리케이션 로드밸런싱)가 있고, 해당 서버와 통신하고 있는 다른 서버 및 클라이언트가 이에 해당된다. 단, ALB를 포함한 다른 AWS 서비스들이 EC2를 연동할 때 IP가 아닌 Instance ID를 사용하고 있다면 IP가 어떻게 바뀌든 간에 영향이 가지 않는다.</p>

<h3 id="ec2-내의-스토리지디스크가-ebs인지-확인하기">EC2 내의 스토리지(디스크)가 EBS인지 확인하기</h3>

<p>EC2의 스토리지 유형은 크게 두 가지가 있다. 하나는 <strong>EBS(Elastic Block Store)</strong>이고 다른 하나는 <strong>인스턴스 스토리지(Instance Storage)</strong>이다. EBS는 EC2와 분리되어 있는 하드디스크 개념으로 EC2가 종료되어도 EBS에 있는 내용은 변경사항이 없지만, 인스턴스 스토리지는 말 그대로 EC2내 부착되는 스토리지이기 때문에 EC2를 종료하는 순간 모든 데이터가 사라지게 된다. 따라서 후술하겠지만, <strong>인스턴스 변경에 앞서 데이터에 대한 백업이 반드시 필요하다.</strong></p>

<p><br /></p>

<p>EC2가 사용하고 있는 스토리지의 유형을 확인하는 방법은 아래와 같다.</p>

<ol>
  <li>EC2 접속</li>
  <li>명령어 <code class="language-plaintext highlighter-rouge">sudo apt install nvme-list</code> 실행</li>
  <li>명령어 <code class="language-plaintext highlighter-rouge">nvme list</code> 실행</li>
</ol>

<p><code class="language-plaintext highlighter-rouge">nvme list</code>를 실행하면 보통 아래와 같이 터미널에 출력이 된다.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Node           SN                  Model                                    
<span class="nt">-------------</span> <span class="nt">--------------------</span> <span class="nt">---------------------------</span>
/dev/nvme0n1  vol074ab31681a94fc83 Amazon Elastic Block Store              
</code></pre></div></div>

<p><br /></p>

<p>Model 부분에서 <code class="language-plaintext highlighter-rouge">Amazon Elastic Block Store</code>라고 출력되어있다면 EBS가 되고, 그렇지 않다면 인스턴스 스토리지다.</p>

<h3 id="아키텍처-체크">아키텍처 체크</h3>

<p><img src="/assets/img/20241129/arch-list.png" alt="arch-list" /></p>

<p>CPU 아키텍처가 Intel x86인지 AMD인지 아니면 다른 것인지 파악을 해야 한다. 유형에 따라 아키텍처가 달라지는데, 이를 고려하지 않고 변경을 하게 된다면, 서비스 운영에 있어 장애를 경험할 수 있다. 예를 들어 Docker의 경우, ARM 계열의 MacOS에서 DockerFile로 이미지를 만들고 x86 계열의 EC2 인스턴스에서 해당 이미지를 생성해서 사용하려면 DockerFile의 맨 위에 아래와 같이 작성해야 한다. 아키텍처가 서로 다르기 때문이다.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">FROM</span><span class="s"> --platform=linux/amd64 &lt;이미지 유형&gt;</span>
</code></pre></div></div>

<h2 id="백업본-만들기-ebs-기준">백업본 만들기 (EBS 기준)</h2>

<p>앞서 서술했듯이 인스턴스를 갈아까우면서 스토리지 상에서 혹여 발생하는 문제들에 대해 대비하기 위해 백업본을 미리 만들어야 한다. EBS와 인스턴스 스토리지 둘다 해당이 되지만, 대부분 EBS를 사용하기 때문에 EBS 위주로 설명한다.</p>

<ol>
  <li>ECS Instances에서 Instance ID를 클릭한다.
<img src="/assets/img/20241129/backup-1.png" alt="backup-1" /></li>
  <li>Storage 탭에서 Volume ID를 클릭한다.
 <img src="/assets/img/20241129/backup-2.png" alt="backup-2" /></li>
  <li>Action 탭에 Create snapshot을 클릭한다.
 <img src="/assets/img/20241129/backup-3.png" alt="backup-3" /></li>
  <li>필요한 설명을 적고 하단의 Create Snapshot을 클릭하면.
 <img src="/assets/img/20241129/backup-4.png" alt="backup-4" /></li>
  <li>EBS의 백업본인 Snapshot이 하나 추가가 되고, “Create volume” 버튼을 통해 언제든지 백업본을 생성할 수 있다.
<img src="/assets/img/20241129/backup-5.png" alt="backup-5" /></li>
</ol>

<h2 id="ec2-유형-변경하기-1"><strong>EC2 유형 변경하기</strong></h2>

<ol>
  <li>유형을 변경하기에 앞서 EC2 인스턴스를 Stop(멈춤) 한다. <strong>절대 Terminate(종료)를 해서는 안된다.</strong>
 <img src="/assets/img/20241129/change-1.png" alt="change-1" /></li>
  <li>actions -&gt; instance settings -&gt; change instance type 으로 진행한다.
 <img src="/assets/img/20241129/change-2.png" alt="change-2" /></li>
  <li>이제 원하는 인스턴스 유형을 고른다. 변경 전과 이후의 인스턴스 스펙 리스트가 있으니 꼭 확인하자. 결정이 됐으면 하단의 Change 버튼을 누른다.
 <img src="/assets/img/20241129/change-3.png" alt="change-3" /></li>
  <li>변경 성공, 이제 인스턴스를 켜서 데이터가 그대로 있는지, 서비스가 정상작동이 되는지 확인을 하면 된다.
 <img src="/assets/img/20241129/change-4.png" alt="change-4" /></li>
</ol>

<h1 id="마치며">마치며</h1>

<p>서비스를 운영하다 보면 사용자 및 트래픽의 증가에 따라, 혹은 비용 절감을 위해 서버 인스턴스의 스펙을 올리거나 내리는 순간이 꼭 한번쯤은 찾아온다. 현장에서 직접 서버의 스펙을 바꾸려면, 본체내 장비들을 일일이 교체해야 함은 물론, 교체 이후의 세팅을 일일이 해야 한다. 하지만, AWS EC2는 이러한 작업을 고작 마우스 딸깍 몇번으로 해결을 해준다.</p>

<p><br /></p>

<p>그러나, 이런 행위는 사실상 서버 본체를 갈아끼우는 것과 같기 때문에, 내부 스토리지의 데이터가 초기화 되거나, Public IP가 뒤바뀌면서, 서비스 작동에 장애를 안겨줄 수 있다. 그렇기 때문에 <strong>AWS EC2 인스턴스 스펙을 바꾸기 전에, 바뀌게 되면 영향이 가는 요소들을 반드시 확인하고, 변경 이후에도 서비스가 정상작동을 하는지에 대한 모니터링이 정말정말 필요하다.</strong></p>


                <div class="
                    mt-6 h-[2px] bg-gradient-to-r
                    from-white via-cyan-400 to-white
                    dark:from-zinc-900 dark:via-yellow-200 dark:to-zinc-900
                "></div>
                <div class="px-4 py-4 flex flex-wrap justify-start gap-x-2.5 gap-y-1.5">
                    
                    <a class="tag" href="/tags/#aws">aws</a>
                    
                    <a class="tag" href="/tags/#ec2">ec2</a>
                    
                </div>

                <script src="https://utteranc.es/client.js"
                    repo="recoma96/recoma96.github.io"
                    issue-term="url"
                    label="blog"
                    theme="github-light"
                    crossorigin="anonymous"
                    async>
                </script>
            </div>
        </div>

        <div class="
    absolute xl:px-[140px] px-mobileX
    w-full bottom-0 flex flex-col pb-10
    text-ornage-800 text-sm text-white font-footer
    bg-lime-600 dark:bg-zinc-900 bg-opacity-80
    dark:border-t shadow-footer-light
    z-footer
">
    <div class="w-full flex flex-wrap justify-center gap-6 mt-6 xl:hidden">
        
<a href="https://github.com/recoma96" class="social-icon text-inherit"><i class="bi bi-github social-icon-color" alt="github"></i></a>



<a href="mailto:seokbong60@gmail.com" class="social-icon text-inherit"><i class="bi bi-envelope-fill social-icon-color" alt="email"></i></a>










    </div>
    <div class="leading-relaxed justify-between mt-6 flex">
        <div>
            <p>Designed by <a href="https://github.com/recoma96" class="no-underline text-blue-800 dark:text-yellow-200">recoma96</a></p>
            <p>Theme by <a href="https://github.com/recoma96/lollineon" class="no-underline text-blue-800 dark:text-yellow-200">LolliNeon</a></p>
        </div>
        <p>Powered by <a href="https://jekyllrb.com/docs/themes" class="no-underline text-blue-800 dark:text-yellow-200">jekyll</a></p>
    </div>
</div>
        <script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript" src="https://recoma96.github.io/assets/js/util.js"></script>
<script type="text/javascript" src="https://recoma96.github.io/assets/js/layout.js"></script>
<script type="text/javascript" src="https://recoma96.github.io/assets/js/navbar.js"></script>
    </body>
</html>